DECLARE @TableName NVARCHAR(128) = 'bas_AAB_Code';
DECLARE @DatabaseName NVARCHAR(128);
DECLARE @SQL NVARCHAR(MAX);

-- 声明游标来遍历所有用户数据库
DECLARE DatabaseCursor CURSOR FOR
SELECT name
FROM sys.databases
WHERE database_id > 4; -- 排除系统数据库

OPEN DatabaseCursor;
FETCH NEXT FROM DatabaseCursor INTO @DatabaseName;

WHILE @@FETCH_STATUS = 0
BEGIN
    SET @SQL = '
        IF EXISTS (SELECT 1 FROM [' + @DatabaseName + '].sys.objects 
                   WHERE object_id = OBJECT_ID(''[' + @DatabaseName + '].[dbo].[' + @TableName + ']'') 
                   AND type IN (N''U''))
        SELECT ''' + @DatabaseName + ''' AS DatabaseName';
    EXEC sp_executesql @SQL;
    FETCH NEXT FROM DatabaseCursor INTO @DatabaseName;
END;

CLOSE DatabaseCursor;
DEALLOCATE DatabaseCursor;